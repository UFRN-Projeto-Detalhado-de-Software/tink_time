<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Artist Registration</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div th:replace="~{fragments/sidebar :: sidebar}"></div>

<div class="container">

    <form th:action="@{/artist/profile/register}" method="post" th:object="${artist}" class="needs-validation" novalidate>

        <input type="hidden" th:field="*{id}"/>
        <input type="hidden" th:field="*{user}"/>
        <input type="hidden" th:field="*{user.id}"/>
        <input type="hidden" th:field="*{styles}" id="artistStyle"/>

        <div class="form-group">
            <label for="aboutMe" style="font-weight: bold">About Me:</label>
            <textarea id="aboutMe" name="aboutMe" th:field="*{aboutMe}" class="form-control"></textarea>
            <span th:if="${#fields.hasErrors('aboutMe')}" th:errors="*{aboutMe}" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label style="font-weight: bold">Styles:</label>
            <div class="row">
                <div class="col-lg-2 col-md-3 col-sm-6" th:each="style : ${allStyles}">
                    <div class="form-check">
                        <input type="checkbox" th:id="${'style_' + style}" th:name="styles" th:value="${style}" class="form-check-input">
                        <label th:for="${'style_' + style}" class="form-check-label" th:text="${style.getDescription()}"></label>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary">Register</button>
        </div>
    </form>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>

    $( document ).ready(function() {
        $('input[type=checkbox]').on('click', function() {
            var selectedStyles = [];
            $('input[type=checkbox]:checked').each(function() {
                selectedStyles.push($(this).val());
            });
            $('#artistStyle').val(selectedStyles.join(','));
        });

        checkSelectedStyles();
    });

    function checkSelectedStyles(){
        var stylesString = document.getElementById('artistStyle').value;
        var stylesList = stylesString.split(',');
        stylesList.forEach((style) => {
            var checkbox = document.getElementById('style_' + style).checked = true;
        })
    }
</script>
</body>
</html>
